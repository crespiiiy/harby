<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="./favicon.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Hacker World - Your Tools, Your Knowledge, Your Power</title>
    <meta name="description" content="Hacker World is a comprehensive platform for ethical hackers, security professionals, and cybersecurity enthusiasts." />

    <!-- Fix específico para errores de constructor en i18next -->
    <script src="./i18n-constructor-fix.js"></script>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

    <!-- Basic styles -->
    <style>
      body {
        background-color: #111827;
        color: #f9fafb;
        font-family: 'Inter', system-ui, sans-serif;
        margin: 0;
        padding: 0;
      }

      .initial-loader {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        height: 100vh;
        width: 100%;
      }

      .loader-title {
        font-size: 2.5rem;
        font-weight: 700;
        margin-bottom: 1.5rem;
        color: #10b981;
      }

      .loader-spinner {
        width: 48px;
        height: 48px;
        border: 4px solid rgba(16, 185, 129, 0.1);
        border-left-color: #10b981;
        border-radius: 50%;
        animation: spin 1s linear infinite;
      }

      @keyframes spin {
        to { transform: rotate(360deg); }
      }
    </style>
    <script type="module" crossorigin src="./assets/index-Ds4KVeZj.js"></script>
    <link rel="modulepreload" crossorigin href="./assets/vendor-C8uJ2DDf.js">
    <link rel="modulepreload" crossorigin href="./assets/i18n-CSajZQ6b.js">
    <link rel="modulepreload" crossorigin href="./assets/utils-DvjpK6Yq.js">
    <link rel="stylesheet" crossorigin href="./assets/index-C-4PF9Qy.css">
  </head>
  <body>
    <div id="root">
      <!-- Initial loading state -->
      <div class="initial-loader">
        <div class="loader-title">Hacker World</div>
        <div class="loader-spinner"></div>
      </div>
    </div>

    <!-- Fallback content -->
    <div id="fallback-content" style="display: none; text-align: center; padding: 20px; margin-top: 50px;">
      <h1 style="color: #10b981; font-size: 2.5rem; margin-bottom: 20px;">Hacker World</h1>
      <p style="color: #f9fafb; font-size: 1.2rem; margin-bottom: 20px;">
        We're experiencing some technical difficulties. Please try refreshing the page.
      </p>
      <button onclick="window.location.reload()" style="background-color: #10b981; color: #111827; border: none; padding: 10px 20px; font-size: 1rem; border-radius: 4px; cursor: pointer;">
        Refresh Page
      </button>
    </div>

    <!-- Error handling script -->
    <script>
      // Make sure We is defined as a constructor
      if (!window.We) {
        console.warn('Constructor We no encontrado, creando uno...');
        window.We = function(options) {
          if (!(this instanceof window.We)) {
            return new window.We(options);
          }
          this.options = options || {};
          this.data = typeof this.options.data === 'function'
            ? this.options.data()
            : (this.options.data || {});

          Object.assign(this, this.data);

          if (typeof this.options.created === 'function') {
            this.options.created.call(this);
          }

          return this;
        };
        window.We.prototype = {
          $emit: function() {},
          $on: function() {},
          $nextTick: function(cb) { setTimeout(cb, 0); },
          $set: function(obj, key, val) {
            if (obj && typeof obj === 'object') {
              obj[key] = val;
            }
          },
          $delete: function(obj, key) {
            if (obj && typeof obj === 'object' && key in obj) {
              delete obj[key];
            }
          },
          $watch: function() { return function() {}; },
          $forceUpdate: function() {},
          $destroy: function() {},
          $mount: function() { return this; }
        };
        window.we = window.We;
        console.log('Constructor We definido en index.html');
      }

      // Show fallback content if the app doesn't load within 15 seconds
      setTimeout(() => {
        if (!window.appLoaded) {
          const root = document.getElementById('root');
          const fallback = document.getElementById('fallback-content');
          if (root && fallback) {
            root.style.display = 'none';
            fallback.style.display = 'block';
            console.error('La aplicación no se cargó dentro del tiempo esperado');
          }
        }
      }, 15000);

      // Global error handler with detailed logging and aggressive constructor fixing
      window.addEventListener('error', function(event) {
        console.error('Error global detectado:', event.error);

        // Log detailed error information
        if (event.error) {
          console.error('Mensaje de error:', event.error.message);
          console.error('Stack de error:', event.error.stack);

          // Create a visible error message for debugging
          const errorDiv = document.createElement('div');
          errorDiv.style.position = 'fixed';
          errorDiv.style.top = '0';
          errorDiv.style.left = '0';
          errorDiv.style.right = '0';
          errorDiv.style.backgroundColor = '#ef4444';
          errorDiv.style.color = 'white';
          errorDiv.style.padding = '10px';
          errorDiv.style.zIndex = '9999';
          errorDiv.textContent = 'Error: ' + (event.error.message || 'Error desconocido');
          document.body.appendChild(errorDiv);

          // Handle constructor errors specifically
          if (event.error.message && event.error.message.includes('is not a constructor')) {
            console.log('Error de constructor detectado:', event.error.message);

            // Extract the constructor name from the error message
            const errorMatch = event.error.message.match(/([A-Za-z]+) is not a constructor/);
            if (errorMatch && errorMatch[1]) {
              const constructorName = errorMatch[1];
              console.log(`Intentando definir constructor faltante: ${constructorName}`);

              // Define the missing constructor
              window[constructorName] = function(options) {
                if (!(this instanceof window[constructorName])) {
                  return new window[constructorName](options);
                }

                this.options = options || {};
                this.data = typeof this.options.data === 'function'
                  ? this.options.data()
                  : (this.options.data || {});

                Object.assign(this, this.data);

                if (typeof this.options.created === 'function') {
                  this.options.created.call(this);
                }

                return this;
              };

              // Add standard Vue-like prototype
              window[constructorName].prototype = {
                $emit: function() {},
                $on: function() {},
                $nextTick: function(cb) { setTimeout(cb, 0); },
                $set: function(obj, key, val) {
                  if (obj && typeof obj === 'object') {
                    obj[key] = val;
                  }
                },
                $delete: function(obj, key) {
                  if (obj && typeof obj === 'object' && key in obj) {
                    delete obj[key];
                  }
                },
                $watch: function() { return function() {}; },
                $forceUpdate: function() {},
                $destroy: function() {},
                $mount: function() { return this; }
              };

              // Also provide lowercase version
              window[constructorName.toLowerCase()] = window[constructorName];

              console.log(`Constructor ${constructorName} definido durante manejo de error`);

              // Prevent the error from propagating
              event.preventDefault();

              // Try to reload the page after a short delay
              setTimeout(() => {
                window.location.reload();
              }, 1000);
            }
          }
        }
      }, true);

      // Additional error handling for unhandled promise rejections
      window.addEventListener('unhandledrejection', function(event) {
        console.error('Unhandled Promise Rejection:', event.reason);

        // Check if the rejection is related to a constructor error
        if (event.reason && event.reason.message && event.reason.message.includes('is not a constructor')) {
          const match = event.reason.message.match(/([A-Za-z]+) is not a constructor/);
          if (match && match[1]) {
            const name = match[1];

            // Define the missing constructor
            if (!window[name]) {
              window[name] = function(options) {
                if (!(this instanceof window[name])) {
                  return new window[name](options);
                }
                this.options = options || {};
                return this;
              };
              window[name].prototype = {
                $emit: function() {},
                $nextTick: function(cb) { setTimeout(cb, 0); }
              };
              window[name.toLowerCase()] = window[name];

              console.log(`Constructor ${name} defined from unhandled rejection`);

              // Prevent the rejection from propagating
              event.preventDefault();

              // Reload the page
              setTimeout(() => window.location.reload(), 1000);
            }
          }
        }
      });

      // Monkey patch Function constructor to handle dynamic constructor creation
      const originalFunction = window.Function;
      window.Function = function() {
        try {
          return originalFunction.apply(this, arguments);
        } catch (error) {
          if (error.message && error.message.includes('is not a constructor')) {
            const match = error.message.match(/([A-Za-z]+) is not a constructor/);
            if (match && match[1]) {
              const name = match[1];
              console.log(`Creating constructor ${name} during Function call`);

              if (!window[name]) {
                window[name] = function(options) {
                  if (!(this instanceof window[name])) {
                    return new window[name](options);
                  }
                  this.options = options || {};
                  return this;
                };
                window[name].prototype = { $emit: function() {} };
                window[name.toLowerCase()] = window[name];
              }

              // Try again
              return originalFunction.apply(this, arguments);
            }
          }
          throw error;
        }
      };
    </script>

    <!-- Main application script -->
  </body>
</html>
